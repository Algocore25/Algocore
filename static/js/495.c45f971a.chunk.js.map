{"version":3,"file":"static/js/495.c45f971a.chunk.js","mappings":"yOAWA,MAwZA,EAxZmBA,KACjB,MAAOC,EAAYC,IAAiBC,EAAAA,EAAAA,UAAS,OACtCC,EAAgBC,IAAqBF,EAAAA,EAAAA,UAAS,KAC9CG,EAAcC,IAAmBJ,EAAAA,EAAAA,UAAS,CAAC,IAC3CK,EAAiBC,IAAsBN,EAAAA,EAAAA,UAAS,IAEhDO,EAASC,IAAcR,EAAAA,EAAAA,WAAS,IAChCS,EAAOC,IAAYV,EAAAA,EAAAA,UAAS,OAC5BW,EAAWC,IAAgBZ,EAAAA,EAAAA,UAAS,OACrC,OAAEa,IAAWC,EAAAA,EAAAA,KACbC,GAAWC,EAAAA,EAAAA,OACX,KAAEC,IAASC,EAAAA,EAAAA,KAGXC,EAAY,uBAAAC,OAA0BP,GACtCQ,EAAS,oBAAAD,OAAuBP,IAGtCS,EAAAA,EAAAA,WAAU,KACR,MAAMC,EAAYC,aAAaC,QAAQN,GACvC,GAAkB,OAAdI,EAAoB,CACtB,MAAMG,EAAMC,SAASJ,EAAW,IAC3BK,OAAOC,MAAMH,IAAMd,EAAac,EACvC,GACC,CAACb,KAGJS,EAAAA,EAAAA,WAAU,KACU,OAAdX,QAAoCmB,IAAdnB,EACxBa,aAAaO,WAAWZ,GAExBK,aAAaQ,QAAQb,EAAcc,OAAOtB,KAE3C,CAACA,EAAWQ,KAGfG,EAAAA,EAAAA,WAAU,KACR,IAAKf,EAAS,CACZ,MAAM2B,EAASV,aAAaC,QAAQJ,GACpC,GAAe,OAAXa,EAAiB,CACnB,MAAMC,EAAIR,SAASO,EAAQ,IACtBN,OAAOC,MAAMM,IAEhBC,sBAAsB,IAAMC,OAAOC,SAAS,EAAGH,GAEnD,CACF,GACC,CAAC5B,EAASc,KAGbC,EAAAA,EAAAA,WAAU,KACR,IAAIiB,GAAU,EACd,MAAMC,EAAWA,KACVD,IACHA,GAAU,EACVH,sBAAsB,KACpB,IACEZ,aAAaQ,QAAQX,EAAWY,OAAOI,OAAOI,SAAWJ,OAAOK,aAAe,GACjF,CAAE,MAAOC,GACP,CACD,QACCJ,GAAU,CACZ,MAMN,OADAF,OAAOO,iBAAiB,SAAUJ,EAAU,CAAEK,SAAS,IAChD,IAAMR,OAAOS,oBAAoB,SAAUN,IACjD,CAACnB,IAGJ,MAAM0B,EAAoBC,UAExB,IAAK/B,EACH,MAAO,CAAC,EAKV,IACE,MAAMgC,GAAQC,EAAAA,EAAAA,IAAIC,EAAAA,IACZC,QAAiBC,EAAAA,EAAAA,KAAIC,EAAAA,EAAAA,IAAML,EAAM,gBAAD7B,OAAkBH,EAAKsC,IAAG,KAAAnC,OAAIP,KAMpE,OAJA2C,QAAQC,IAAI,gBAADrC,OAAiBH,EAAKsC,IAAG,KAAAnC,OAAIP,IACxC2C,QAAQC,IAAI,YAAaL,EAASM,OAG3BN,EAASO,SAAWP,EAASM,MAAQ,CAAC,CAC/C,CAAE,MAAOjD,GAEP,OADA+C,QAAQ/C,MAAM,gCAAiCA,GACxC,CAAC,CACV,GAGImD,EAAsBZ,UAC1B,IACE,MAAMC,GAAQC,EAAAA,EAAAA,IAAIC,EAAAA,IACZC,QAAiBC,EAAAA,EAAAA,KAAIC,EAAAA,EAAAA,IAAML,EAAM,aAAD7B,OAAeP,EAAM,cAE3D,IAAKuC,EAASO,SAEZ,OADAH,QAAQC,IAAI,qBACL,GAGT,MAAMI,EAAOT,EAASM,MAChBzD,EAAiB,SACI8C,IAuC3B,OArCAS,QAAQC,IAAII,GAIZC,OAAOC,KAAKF,GAAMG,QAAQC,IAAa,IAADC,EACpC,MAAMC,EAAYN,EAAKI,GAGvB,GAAyB,kBAAdE,IAA2BA,EAAUC,YAC9C,OAGF,MAAMC,EAAW,GAEjBb,QAAQC,IAAIU,GAEO,QAAnBD,EAAAC,EAAUG,iBAAS,IAAAJ,GAAnBA,EAAqBF,QAAQO,IAC3Bf,QAAQC,IAAIc,GAEZF,EAASG,KAAK,CACZC,KAAMF,EACNG,OAAQ,cACRC,WAAY,OACZC,SAAUL,MAKdtE,EAAeuE,KAAK,CAClBK,MAAOZ,EACPG,YAAaD,EAAUC,YACvBC,SAAUA,EACVK,OAAQP,EAAUO,WAKfzE,CACT,CAAE,MAAOQ,GAEP,MADA+C,QAAQ/C,MAAM,qCAAsCA,GAC9CA,CACR,GAyGF,IArDAa,EAAAA,EAAAA,WAAU,MAER0B,iBACE,IACExC,GAAW,GAEX,MAAMyC,GAAQC,EAAAA,EAAAA,IAAIC,EAAAA,IACZC,QAAiBC,EAAAA,EAAAA,KAAIC,EAAAA,EAAAA,IAAML,EAAM,YAAD7B,OAAcP,EAAM,aAE1D,IAAIuC,EAASO,SAMX,MAAM,IAAImB,MAAM,+BANK,CACrB,MAAMjB,EAAOT,EAASM,MACtB3D,EAAc8D,EAEhB,CAKA,MAAOkB,EAAQC,SAAkBC,QAAQC,IAAI,CAC3CtB,IACAb,MAGIoC,EAxE8BC,EAACL,EAAQC,IAC5CA,GAAgC,kBAAbA,EAEjBD,EAAOM,IAAIC,IAChB,MAAMC,EAAgBP,EAASM,EAAMT,QAAU,CAAC,EAE1CW,EAAkBF,EAAMjB,SAASgB,IAAII,IACzC,IAAIf,EAAS,cAMb,OAJIe,EAAQhB,QAAQc,IAClBb,GAAyC,IAAhCa,EAAcE,EAAQhB,MAAiB,YAAc,kBAGhEiB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACKD,GAAO,IACVf,OAAQA,MAIZ,OAAAgB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACKJ,GAAK,IACRjB,SAAUmB,MApBwCT,EAuE5BK,CAAkCL,EAAQC,GAChE9E,EAAkBiF,GAGlB,MAAMQ,EAlDsBZ,KAChC,IAAIa,EAAQ,EACRC,EAAY,EAShB,OAPAd,EAAOf,QAAQsB,IACbA,EAAMjB,SAASL,QAAQyB,IACrBG,IACuB,cAAnBH,EAAQf,QAAwBmB,QAIjCD,EAAQ,EAAIE,KAAKC,MAAOF,EAAYD,EAAS,KAAO,GAuCnCI,CAAyBb,GAC7C7E,EAAmBqF,EAErB,CAAE,MAAOM,GACPzC,QAAQ/C,MAAM,uBAAwBwF,GACtCvF,EAASuF,EAAIC,SACbhG,EAAkB,KACpB,CAAC,QACCM,GAAW,EACb,CACF,CAIA2F,IAKC,CAACtF,EAAQI,IAERV,GACD6F,EAAAA,EAIC3F,EACF,OAAO4F,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gDAA+CC,SAAA,CAAC,UAAQ9F,KAGhF,IAAKX,EACH,OAAO,KAGT,MAAM,MAAE+E,EAAK,YAAET,EAAW,MAAEoC,GAAU1G,EAChC2G,EAAgBxG,EAAeyG,OAAO,CAACC,EAAOrB,IAAUqB,EAAQrB,EAAMjB,SAASuC,OAAQ,GAEvFC,EAAoB5G,EAAeyG,OACvC,CAACC,EAAOrB,IAAUqB,EAAQrB,EAAMjB,SAASyC,OAAOC,GAAkB,cAAbA,EAAErC,QAAwBkC,OAC/E,GAIF,OACEI,EAAAA,EAAAA,KAAA,OAAKV,UAAU,gFAA+EC,UAC5FS,EAAAA,EAAAA,KAAA,OAAKV,UAAU,8CAA6CC,UAC1DS,EAAAA,EAAAA,KAAA,OAAKV,UAAU,wCAAuCC,UACpDF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeC,SAAA,EAC5BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBC,SAAA,EACrCS,EAAAA,EAAAA,KAAA,OAAKV,UAAU,sDAAqDC,UAClES,EAAAA,EAAAA,KAACC,EAAAA,IAAM,CAACX,UAAU,gDAEpBU,EAAAA,EAAAA,KAAA,MAAIV,UAAU,qBAAoBC,SAAE1B,QAEtCmC,EAAAA,EAAAA,KAAA,KAAGV,UAAU,wCAAuCC,SAAEnC,IAIrDnD,IACCoF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAMC,SAAA,EACnBS,EAAAA,EAAAA,KAAA,MAAIV,UAAU,6BAA4BC,SAAC,qBAC3CS,EAAAA,EAAAA,KAAA,OAAKV,UAAU,uDAAsDC,UACnES,EAAAA,EAAAA,KAAA,OACEV,UAAU,uEACVY,MAAO,CAAEC,MAAM,GAAD/F,OAAKf,EAAe,WAGtCgG,EAAAA,EAAAA,MAAA,KAAGC,UAAU,gDAA+CC,SAAA,CAAElG,EAAgB,kBAC9EgG,EAAAA,EAAAA,MAAA,KAAGC,UAAU,gDAA+CC,SAAA,CAAEM,EAAkB,6BAIpFR,EAAAA,EAAAA,MAAA,OAAKC,UAAU,4EAA2EC,SAAA,EACxFF,EAAAA,EAAAA,MAAA,QAAAE,SAAA,CAAOE,EAAc,gBAErBO,EAAAA,EAAAA,KAAA,QAAAT,SAAOC,EAAMY,YAIbnG,IACA+F,EAAAA,EAAAA,KAAA,OAAKV,UAAU,wEAAuEC,UACpFF,EAAAA,EAAAA,MAAA,KAAGC,UAAU,2CAA0CC,SAAA,CAAC,WAC/CS,EAAAA,EAAAA,KAAA,KAAGK,KAAK,SAASf,UAAU,mDAAkDC,SAAC,UAAS,gCAKpGS,EAAAA,EAAAA,KAAA,MAAIV,UAAU,0BAAyBC,SAAC,cACxCS,EAAAA,EAAAA,KAAA,OAAKV,UAAU,YAAWC,SACvBtG,EAAeoF,IAAI,CAACC,EAAOgC,KAC1B,MAAM,MAAE1B,EAAK,UAAEC,EAAS,QAAE0B,GA9HRjC,KAAW,IAADkC,EACxC,MAAM5B,GAAa,OAALN,QAAK,IAALA,GAAe,QAAVkC,EAALlC,EAAOjB,gBAAQ,IAAAmD,OAAV,EAALA,EAAiBZ,SAAU,EACnCf,IAAkB,OAALP,QAAK,IAALA,OAAK,EAALA,EAAOjB,WAAY,IAAIyC,OAAOC,GAAkB,cAAbA,EAAErC,QAAwBkC,OAEhF,MAAO,CAAEhB,QAAOC,YAAW0B,QADX3B,EAAQ,EAAIE,KAAKC,MAAOF,EAAYD,EAAS,KAAO,IA2HlB6B,CAAuBnC,GAC7D,OACEe,EAAAA,EAAAA,MAAA,OAAiBC,UAAU,uGAAsGC,SAAA,EAC/HF,EAAAA,EAAAA,MAAA,OACEC,UAAU,uDACVoB,QAASA,IAAM9G,EAAaD,IAAc2G,EAAQ,KAAOA,GAAOf,SAAA,EAEhEF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAChCS,EAAAA,EAAAA,KAAA,OAAKV,UAAU,mHAAkHC,SAAEe,EAAQ,KAC3IjB,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACES,EAAAA,EAAAA,KAAA,MAAIV,UAAU,wBAAuBC,SAAEjB,EAAMT,MAAM8C,QAAQ,2BAA4B,SACvFX,EAAAA,EAAAA,KAAA,KAAGV,UAAU,2CAA0CC,SAAEjB,EAAMlB,qBAGnEiC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,8BAA6BC,SAAA,EAC1CF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kBAAiBC,SAAA,EAC9BS,EAAAA,EAAAA,KAAA,OAAKV,UAAU,qDAAoDC,UACjES,EAAAA,EAAAA,KAAA,OAAKV,UAAU,2DAA2DY,MAAO,CAAEC,MAAM,GAAD/F,OAAKmG,EAAO,WAEtGlB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,2DAA0DC,SAAA,CAAEV,EAAU,IAAED,SAEzFS,EAAAA,EAAAA,MAAA,QAAMC,UAAU,qDAAoDC,SAAA,CAAEgB,EAAQ,QAC9EP,EAAAA,EAAAA,KAACY,EAAAA,IAAa,CAACtB,UAAS,8CAAAlF,OAAgDT,IAAc2G,EAAQ,aAAe,YAGhH3G,IAAc2G,GAAShC,EAAMjB,SAASuC,OAAS,IAC9CI,EAAAA,EAAAA,KAAA,OAAKV,UAAU,qDAAoDC,UACjEF,EAAAA,EAAAA,MAAA,SAAOC,UAAU,2BAA0BC,SAAA,EACzCS,EAAAA,EAAAA,KAAA,SAAOV,UAAU,mCAAkCC,UACjDF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EACES,EAAAA,EAAAA,KAAA,MAAIV,UAAU,kBAAiBC,SAAC,kBAChCS,EAAAA,EAAAA,KAAA,MAAIV,UAAU,kBAAiBC,SAAC,YAChCS,EAAAA,EAAAA,KAAA,MAAIV,UAAU,kBAAiBC,SAAC,qBAGpCS,EAAAA,EAAAA,KAAA,SAAAT,SACGjB,EAAMjB,SAASgB,IAAI,CAACI,EAASoC,KAC5BxB,EAAAA,EAAAA,MAAA,MAEEC,UAAS,sDAAAlF,OAAyE,YAAjBkE,EAAMZ,OAAuB,aAAe,8CAA+C6B,SAAA,EAE5JF,EAAAA,EAAAA,MAAA,MACEC,UAAS,yBAAAlF,OAA4C,YAAjBkE,EAAMZ,OACtC,sDACA,mEACJgD,QAASA,KACc,YAAjBpC,EAAMZ,QACR3D,EAAS,YAADK,OAAaP,EAAM,KAAAO,OAAIkE,EAAMT,MAAK,KAAAzD,OAAIqE,EAAQhB,QAExD8B,SAAA,CAEkB,cAAnBd,EAAQf,SACPsC,EAAAA,EAAAA,KAACc,EAAAA,IAAO,CAACxB,UAAU,wBAEpBb,EAAQhB,KACS,YAAjBa,EAAMZ,SACLsC,EAAAA,EAAAA,KAAA,QAAMV,UAAU,iGAAgGC,SAAC,eAKrHS,EAAAA,EAAAA,KAAA,MAAIV,UAAU,MAAKC,UACjBS,EAAAA,EAAAA,KAAA,QAAMV,UAAS,kCAAAlF,OAAuD,cAAnBqE,EAAQf,OACvD,uEACA,iEACC6B,SACFd,EAAQf,YAGbsC,EAAAA,EAAAA,KAAA,MAAIV,UAAU,yCAAwCC,SAAEd,EAAQd,eA/B3DkD,aApCTP,gB","sources":["pages/CoursePage.jsx"],"sourcesContent":["\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { FaChevronRight, FaStar, FaBook, FaAward, FaChevronDown, FaCheck } from 'react-icons/fa';\r\nimport { ref, get, child } from 'firebase/database';\r\nimport { database } from '../firebase';\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\nimport LoadingPage from './LoadingPage';\r\n\r\nconst CoursePage = () => {\r\n  const [courseData, setCourseData] = useState(null);\r\n  const [practiceTopics, setPracticeTopics] = useState([]);\r\n  const [userProgress, setUserProgress] = useState({});\r\n  const [progressPercent, setProgressPercent] = useState(0);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [openTopic, setOpenTopic] = useState(null);\r\n  const { course } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n\r\n  // Local storage keys per course\r\n  const openTopicKey = `coursePageOpenTopic:${course}`;\r\n  const scrollKey = `coursePageScroll:${course}`;\r\n\r\n  // Restore open topic from localStorage (once on course change)\r\n  useEffect(() => {\r\n    const savedOpen = localStorage.getItem(openTopicKey);\r\n    if (savedOpen !== null) {\r\n      const idx = parseInt(savedOpen, 10);\r\n      if (!Number.isNaN(idx)) setOpenTopic(idx);\r\n    }\r\n  }, [course]);\r\n\r\n  // Persist open topic whenever it changes\r\n  useEffect(() => {\r\n    if (openTopic === null || openTopic === undefined) {\r\n      localStorage.removeItem(openTopicKey);\r\n    } else {\r\n      localStorage.setItem(openTopicKey, String(openTopic));\r\n    }\r\n  }, [openTopic, openTopicKey]);\r\n\r\n  // Restore scroll position after data loads\r\n  useEffect(() => {\r\n    if (!loading) {\r\n      const savedY = localStorage.getItem(scrollKey);\r\n      if (savedY !== null) {\r\n        const y = parseInt(savedY, 10);\r\n        if (!Number.isNaN(y)) {\r\n          // Defer to ensure layout is ready\r\n          requestAnimationFrame(() => window.scrollTo(0, y));\r\n        }\r\n      }\r\n    }\r\n  }, [loading, scrollKey]);\r\n\r\n  // Track and persist scroll position (throttled via rAF)\r\n  useEffect(() => {\r\n    let ticking = false;\r\n    const onScroll = () => {\r\n      if (!ticking) {\r\n        ticking = true;\r\n        requestAnimationFrame(() => {\r\n          try {\r\n            localStorage.setItem(scrollKey, String(window.scrollY || window.pageYOffset || 0));\r\n          } catch (e) {\r\n            // ignore storage failures\r\n          } finally {\r\n            ticking = false;\r\n          }\r\n        });\r\n      }\r\n    };\r\n\r\n    window.addEventListener('scroll', onScroll, { passive: true });\r\n    return () => window.removeEventListener('scroll', onScroll);\r\n  }, [scrollKey]);\r\n\r\n\r\n  const fetchUserProgress = async () => {\r\n\r\n    if (!user) {\r\n      return {};\r\n    }\r\n\r\n    // console.log(user);\r\n\r\n    try {\r\n      const dbRef = ref(database);\r\n      const snapshot = await get(child(dbRef, `userprogress/${user.uid}/${course}`));\r\n\r\n      console.log(`userprogress/${user.uid}/${course}`);\r\n      console.log(\"Snapshot:\", snapshot.val());\r\n\r\n\r\n      return snapshot.exists() ? snapshot.val() : {};\r\n    } catch (error) {\r\n      console.error('Error fetching user progress:', error);\r\n      return {};\r\n    }\r\n  };\r\n\r\n  const fetchPracticeTopics = async () => {\r\n    try {\r\n      const dbRef = ref(database);\r\n      const snapshot = await get(child(dbRef, `/AlgoCore/${course}/lessons`));\r\n\r\n      if (!snapshot.exists()) {\r\n        console.log('No data available');\r\n        return [];\r\n      }\r\n\r\n      const data = snapshot.val();\r\n      const practiceTopics = [];\r\n      const progressData = await fetchUserProgress();\r\n\r\n      console.log(data);\r\n\r\n\r\n      // Process each topic\r\n      Object.keys(data).forEach(topicKey => {\r\n        const topicData = data[topicKey];\r\n\r\n        // Skip if it's not a topic object\r\n        if (typeof topicData !== 'object' || !topicData.description) {\r\n          return;\r\n        }\r\n\r\n        const problems = [];\r\n\r\n        console.log(topicData);\r\n\r\n        topicData.questions?.forEach(problemData => {\r\n          console.log(problemData);\r\n\r\n          problems.push({\r\n            name: problemData,\r\n            status: 'Not Started', // Default status\r\n            difficulty: \"Easy\",\r\n            question: problemData,\r\n          });\r\n        });\r\n\r\n        // Create the topic object\r\n        practiceTopics.push({\r\n          title: topicKey,\r\n          description: topicData.description,\r\n          problems: problems,\r\n          status: topicData.status\r\n        });\r\n      });\r\n\r\n\r\n      return practiceTopics;\r\n    } catch (error) {\r\n      console.error('Error fetching data from Firebase:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const updateProblemStatusesWithProgress = (topics, progress) => {\r\n    if (!progress || typeof progress !== 'object') return topics;\r\n\r\n    return topics.map(topic => {\r\n      const topicProgress = progress[topic.title] || {};\r\n\r\n      const updatedProblems = topic.problems.map(problem => {\r\n        let status = 'Not Started'; // default\r\n\r\n        if (problem.name in topicProgress) {\r\n          status = topicProgress[problem.name] === true ? 'Completed' : 'Not Completed';\r\n        }\r\n\r\n        return {\r\n          ...problem,\r\n          status: status\r\n        };\r\n      });\r\n\r\n      return {\r\n        ...topic,\r\n        problems: updatedProblems\r\n      };\r\n    });\r\n  };\r\n\r\n  const calculateProgressPercent = (topics) => {\r\n    let total = 0;\r\n    let completed = 0;\r\n\r\n    topics.forEach(topic => {\r\n      topic.problems.forEach(problem => {\r\n        total++;\r\n        if (problem.status === 'Completed') completed++;\r\n      });\r\n    });\r\n\r\n    return total > 0 ? Math.round((completed / total) * 100) : 0;\r\n  };\r\n\r\n  const calculateTopicProgress = (topic) => {\r\n    const total = topic?.problems?.length || 0;\r\n    const completed = (topic?.problems || []).filter(p => p.status === 'Completed').length;\r\n    const percent = total > 0 ? Math.round((completed / total) * 100) : 0;\r\n    return { total, completed, percent };\r\n  };\r\n\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    async function executeAfterBoth() {\r\n      try {\r\n        setLoading(true);\r\n\r\n        const dbRef = ref(database);\r\n        const snapshot = await get(child(dbRef, `AlgoCore/${course}/course`));\r\n\r\n        if (snapshot.exists()) {\r\n          const data = snapshot.val();\r\n          setCourseData(data);\r\n\r\n        }\r\n        else {\r\n          throw new Error('Failed to fetch course data');\r\n        }\r\n\r\n        const [topics, progress] = await Promise.all([\r\n          fetchPracticeTopics(),\r\n          fetchUserProgress()\r\n        ]);\r\n\r\n        const updatedTopics = updateProblemStatusesWithProgress(topics, progress);\r\n        setPracticeTopics(updatedTopics);\r\n\r\n        // Set the % value\r\n        const progressVal = calculateProgressPercent(updatedTopics);\r\n        setProgressPercent(progressVal);\r\n\r\n      } catch (err) {\r\n        console.error('Error fetching data:', err);\r\n        setError(err.message);\r\n        setPracticeTopics(null);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n\r\n\r\n    executeAfterBoth();\r\n\r\n\r\n\r\n\r\n  }, [course, user]);\r\n\r\n  if (loading) {\r\n    <LoadingPage />\r\n    // return <div className=\"flex justify-center items-center min-h-screen\">Loading...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"flex justify-center items-center min-h-screen\">Error: {error}</div>;\r\n  }\r\n\r\n  if (!courseData) {\r\n    return null;\r\n  }\r\n\r\n  const { title, description, stats } = courseData;\r\n  const totalProblems = practiceTopics.reduce((count, topic) => count + topic.problems.length, 0);\r\n\r\n  const completedProblems = practiceTopics.reduce(\r\n    (count, topic) => count + topic.problems.filter(p => p.status === 'Completed').length,\r\n    0\r\n  );\r\n\r\n\r\n  return (\r\n    <div className=\"bg-gray-50 dark:bg-dark-primary text-gray-900 dark:text-gray-100 min-h-screen\">\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n          <div className=\"lg:col-span-2\">\r\n            <div className=\"flex items-center mb-4\">\r\n              <div className=\"bg-blue-100 dark:bg-blue-900/50 p-3 rounded-lg mr-4\">\r\n                <FaBook className=\"w-8 h-8 text-blue-600 dark:text-blue-400\" />\r\n              </div>\r\n              <h1 className=\"text-4xl font-bold\">{title}</h1>\r\n            </div>\r\n            <p className=\"text-gray-600 dark:text-gray-300 mb-4\">{description}</p>\r\n\r\n            {/* Progress Bar */}\r\n            {/* Progress Bar */}\r\n            {user && (\r\n              <div className=\"mb-6\">\r\n                <h3 className=\"text-lg font-semibold mb-2\">Course Progress</h3>\r\n                <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4\">\r\n                  <div\r\n                    className=\"bg-blue-600 h-4 rounded-full transition-all duration-500 ease-in-out\"\r\n                    style={{ width: `${progressPercent}%` }}\r\n                  ></div>\r\n                </div>\r\n                <p className=\"mt-2 text-sm text-gray-600 dark:text-gray-300\">{progressPercent}% Completed</p>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">{completedProblems} Problems Completed</p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex items-center space-x-6 text-sm text-gray-600 dark:text-gray-400 mb-6\">\r\n              <span>{totalProblems} Problems</span>\r\n\r\n              <span>{stats.level}</span>\r\n            </div>\r\n\r\n\r\n            {!user && (\r\n              <div className=\"border-t border-b border-gray-200 dark:border-dark-tertiary py-4 mb-8\">\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                  Please <a href=\"/login\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">login</a> to track your progress\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            <h2 className=\"text-2xl font-bold mb-4\">Problems</h2>\r\n            <div className=\"space-y-4\">\r\n              {practiceTopics.map((topic, index) => {\r\n                const { total, completed, percent } = calculateTopicProgress(topic);\r\n                return (\r\n                  <div key={index} className=\"bg-white dark:bg-dark-tertiary rounded-lg shadow-sm border border-gray-200 dark:border-dark-tertiary\">\r\n                    <div\r\n                      className=\"p-4 flex justify-between items-center cursor-pointer\"\r\n                      onClick={() => setOpenTopic(openTopic === index ? null : index)}\r\n                    >\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"bg-gray-100 dark:bg-dark-tertiary rounded-full w-10 h-10 flex items-center justify-center mr-4 font-bold text-lg\">{index + 1}</div>\r\n                        <div>\r\n                          <h3 className=\"font-semibold text-lg\">{topic.title.replace(/^[^a-zA-Z]*([a-zA-Z].*)$/, '$1')}</h3>\r\n                          <p className=\"text-sm text-gray-500 dark:text-gray-400\">{topic.description}</p>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-center space-x-4\">\r\n                        <div className=\"hidden sm:block\">\r\n                          <div className=\"w-24 bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\r\n                            <div className=\"bg-blue-600 h-2 rounded-full transition-all duration-500\" style={{ width: `${percent}%` }}></div>\r\n                          </div>\r\n                          <div className=\"mt-1 text-xs text-gray-500 dark:text-gray-400 text-right\">{completed}/{total}</div>\r\n                        </div>\r\n                        <span className=\"text-sm text-gray-600 dark:text-gray-300 sm:hidden\">{percent}%</span>\r\n                        <FaChevronDown className={`w-5 h-5 text-gray-400 transition-transform ${openTopic === index ? 'rotate-180' : ''}`} />\r\n                      </div>\r\n                    </div>\r\n                    {openTopic === index && topic.problems.length > 0 && (\r\n                      <div className=\"border-t border-gray-200 dark:border-dark-tertiary\">\r\n                        <table className=\"w-full text-left text-sm\">\r\n                          <thead className=\"text-gray-500 dark:text-gray-400\">\r\n                            <tr>\r\n                              <th className=\"p-4 font-medium\">Problem Name</th>\r\n                              <th className=\"p-4 font-medium\">Status</th>\r\n                              <th className=\"p-4 font-medium\">Difficulty</th>\r\n                            </tr>\r\n                          </thead>\r\n                          <tbody>\r\n                            {topic.problems.map((problem, pIndex) => (\r\n                              <tr \r\n                                key={pIndex} \r\n                                className={`border-t border-gray-200 dark:border-dark-tertiary ${topic.status === 'blocked' ? 'opacity-60' : 'hover:bg-gray-50 dark:hover:bg-gray-700/50'}`}\r\n                              >\r\n                                <td\r\n                                  className={`p-4 flex items-center ${topic.status === 'blocked' \r\n                                    ? 'text-gray-400 dark:text-gray-500 cursor-not-allowed' \r\n                                    : 'text-blue-600 dark:text-blue-400 hover:underline cursor-pointer'}`}\r\n                                  onClick={() => {\r\n                                    if (topic.status !== 'blocked') {\r\n                                      navigate(`/problem/${course}/${topic.title}/${problem.name}`);\r\n                                    }\r\n                                  }}\r\n                                >\r\n                                  {problem.status === 'Completed' && (\r\n                                    <FaCheck className=\"text-green-500 mr-2\" />\r\n                                  )}\r\n                                  {problem.name}\r\n                                  {topic.status === 'blocked' && (\r\n                                    <span className=\"ml-2 text-xs bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 px-2 py-0.5 rounded\">\r\n                                      Locked\r\n                                    </span>\r\n                                  )}\r\n                                </td>\r\n                                <td className=\"p-4\">\r\n                                  <span className={`px-2 py-1 rounded-full text-xs ${problem.status === 'Completed'\r\n                                    ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400'\r\n                                    : 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'\r\n                                    }`}>\r\n                                    {problem.status}\r\n                                  </span>\r\n                                </td>\r\n                                <td className=\"p-4 text-green-600 dark:text-green-400\">{problem.difficulty}</td>\r\n                              </tr>\r\n                            ))}\r\n                          </tbody>\r\n                        </table>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CoursePage;"],"names":["CoursePage","courseData","setCourseData","useState","practiceTopics","setPracticeTopics","userProgress","setUserProgress","progressPercent","setProgressPercent","loading","setLoading","error","setError","openTopic","setOpenTopic","course","useParams","navigate","useNavigate","user","useAuth","openTopicKey","concat","scrollKey","useEffect","savedOpen","localStorage","getItem","idx","parseInt","Number","isNaN","undefined","removeItem","setItem","String","savedY","y","requestAnimationFrame","window","scrollTo","ticking","onScroll","scrollY","pageYOffset","e","addEventListener","passive","removeEventListener","fetchUserProgress","async","dbRef","ref","database","snapshot","get","child","uid","console","log","val","exists","fetchPracticeTopics","data","Object","keys","forEach","topicKey","_topicData$questions","topicData","description","problems","questions","problemData","push","name","status","difficulty","question","title","Error","topics","progress","Promise","all","updatedTopics","updateProblemStatusesWithProgress","map","topic","topicProgress","updatedProblems","problem","_objectSpread","progressVal","total","completed","Math","round","calculateProgressPercent","err","message","executeAfterBoth","LoadingPage","_jsxs","className","children","stats","totalProblems","reduce","count","length","completedProblems","filter","p","_jsx","FaBook","style","width","level","href","index","percent","_topic$problems","calculateTopicProgress","onClick","replace","FaChevronDown","pIndex","FaCheck"],"sourceRoot":""}